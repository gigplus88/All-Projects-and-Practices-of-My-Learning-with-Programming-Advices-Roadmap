using System;
using System.Data;
using System.Data.SqlClient;
using static System.Net.Mime.MediaTypeNames;
using System.Diagnostics;
using System.Configuration;


class Program
{
    static void Main()
    {


//with using statment
        int NewPersonID;

        try
        {
            string connectionString = ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString;
            using (SqlConnection connection = new SqlConnection(connectionString))
            {
                connection.Open();

                using (SqlCommand command = new SqlCommand("SP_AddNewPerson", connection))
                {
                    command.CommandType = CommandType.StoredProcedure;

                    command.Parameters.AddWithValue("@FirstName", "Saad");
                    command.Parameters.AddWithValue("@LastName", "Doe");
                    command.Parameters.AddWithValue("@Email", "john.doe@example.com");

                    SqlParameter outputIdParam = new SqlParameter("@PersonID", SqlDbType.Int)
                    {
                        Direction = ParameterDirection.Output
                    };

                    command.Parameters.Add(outputIdParam);
                    command.ExecuteNonQuery();

                    if (command.Parameters["@PersonID"].Value != DBNull.Value)
                    {
                        NewPersonID = Convert.ToInt32(command.Parameters["@PersonID"].Value);
                        Console.WriteLine($"New Person ID: {NewPersonID}");
                    }

                }
            }

        }
        catch (Exception ex)
        {

            Console.WriteLine($" Person doesn't Added   {ex.Message}");
        }




















//Without using statment
        int ApplicationID;

        string connectionString = ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString;

        SqlConnection connection = new SqlConnection(connectionString);
        SqlCommand command = new SqlCommand("SP_AddNewPerson", connection);



        command.CommandType = CommandType.StoredProcedure;


        // Add parameters
        command.Parameters.AddWithValue("@FirstName", "John");
        command.Parameters.AddWithValue("@LastName", "Doe");
        command.Parameters.AddWithValue("@Email", "john.doe@example.com");
        SqlParameter outputIdParam = new SqlParameter("@NewPersonID", SqlDbType.Int)
        {
            Direction = ParameterDirection.Output
        };
        command.Parameters.Add(outputIdParam);

        try
        {
            connection.Open();

            command.ExecuteNonQuery();  

            if (command.Parameters["@NewPersonID"].Value != DBNull.Value)
            {
                ApplicationID = Convert.ToInt32(command.Parameters["@NewPersonID"].Value);
                Console.WriteLine($"New Person ID: {ApplicationID}");
            }

        }

        catch (Exception ex)
        {
            Console.WriteLine("Error: " + ex.Message);
            //clsEventLog clsEventLog = new clsEventLog("AddNewApplication");
            //clsEventLog.AddEventLog(ex, eventLogEntryType: EventLogEntryType.Error);
        }
       

        // Retrieve the ID of the new person
       


        connection.Close();
    }
}

